(function(a){a.fn.colorPicker=function(){this.length>0&&buildSelector();return this.each(function(){buildPicker(this)})};var c,d=!1;buildPicker=function(b){control=a("<div class='color_picker'>&nbsp;</div>");control.css("background-color",a(b).val());control.bind("click",toggleSelector);a(b).after(control);a(b).bind("change",function(){selectedValue=toHex(a(b).val());a(b).next(".color_picker").css("background-color",selectedValue)});a(b).hide()};buildSelector=function(){selector=a("<div id='color_selector'></div>");
a.each(a.fn.colorPicker.defaultColors,function(){swatch=a("<div class='color_swatch'>&nbsp;</div>");swatch.css("background-color","#"+this);swatch.bind("click",function(){changeColor(a(this).css("background-color"))});swatch.bind("mouseover",function(){a(this).css("border-color","#598FEF");a("input#color_value").val(toHex(a(this).css("background-color")))});swatch.bind("mouseout",function(){a(this).css("border-color","#000");a("input#color_value").val(toHex(a(c).css("background-color")))});swatch.appendTo(selector)});
hex_field=a("<label for='color_value'>Hex</label><input type='text' size='8' id='color_value'/>");hex_field.bind("keydown",function(b){b.keyCode==13&&changeColor(a(this).val());b.keyCode==27&&toggleSelector()});a("<div id='color_custom'></div>").append(hex_field).appendTo(selector);a("body").append(selector);selector.hide()};checkMouse=function(b){var e=a(b.target).parents("div#color_selector").length;b.target==a("div#color_selector")[0]||b.target==c||e>0||hideSelector()};hideSelector=function(){var b=
a("div#color_selector");a(document).unbind("mousedown",checkMouse);b.hide();d=!1};showSelector=function(){var b=a("div#color_selector");b.css({top:a(c).offset().top+a(c).outerHeight(),left:a(c).offset().left});hexColor=a(c).prev("input").val();a("input#color_value").val(hexColor);b.show();a(document).bind("mousedown",checkMouse);d=!0};toggleSelector=function(){c=this;d?hideSelector():showSelector()};changeColor=function(b){if(selectedValue=toHex(b))a(c).css("background-color",selectedValue),a(c).prev("input").val(selectedValue).change(),
hideSelector()};toHex=function(a){if(a.match(/[0-9a-fA-F]{3}$/)||a.match(/[0-9a-fA-F]{6}$/))a=a.charAt(0)=="#"?a:"#"+a;else if(a.match(/^rgb\(([0-9]|[1-9][0-9]|[1][0-9]{2}|[2][0-4][0-9]|[2][5][0-5]),[ ]{0,1}([0-9]|[1-9][0-9]|[1][0-9]{2}|[2][0-4][0-9]|[2][5][0-5]),[ ]{0,1}([0-9]|[1-9][0-9]|[1][0-9]{2}|[2][0-4][0-9]|[2][5][0-5])\)$/)){var c=[parseInt(RegExp.$1),parseInt(RegExp.$2),parseInt(RegExp.$3)],d=function(a){if(a.length<2)for(var b=0,c=2-a.length;b<c;b++)a="0"+a;return a};if(c.length==3)var a=
d(c[0].toString(16)),f=d(c[1].toString(16)),c=d(c[2].toString(16)),a="#"+a+f+c}else a=!1;return a};a.fn.colorPicker.addColors=function(b){a.fn.colorPicker.defaultColors=a.fn.colorPicker.defaultColors.concat(b)};a.fn.colorPicker.defaultColors="000000,993300,333300,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFFF,99CCFF,FFFFFF".split(",")})(jQuery);
